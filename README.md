<img height=64 src="https://github.com/ArKaNeMaN/amxx-DeathGift/blob/master/IconBar-96.png?raw=true" alt="DeathGift-IconBar"/>

## Описание

Плагин доабвляет в игру подарки, которые с каким-то шансом выпадают при смерти игрока.

Содержимое подарков можно настроить как вам угодно.

#### [Расширения](https://github.com/ArKaNeMaN/amxx-DeathGift-Extentions)

## Требования

- [AmxModX-1.8.3](https://www.amxmodx.org/downloads-new.php) или новее

## Квары

Файл `amxmodx/configs/plugins/DeathGift/Main.cfg`.

- `DG_DropRarity`
  - Шанс выпадения подарка при смерти
  - По умолчанию: 0.1

- `DG_LifeTime`
  - Время "жизни" подарка
  - По умолчанию: 15

- `DG_Money_Min`
  - Минимальное кол-во денег, которое может выпасть из подарка
  - По умолчанию: 500

- `DG_Money_Max`
  - Максимальное кол-во денег, которое может выпасть из подарка
  - По умолчанию: 5000

- `DG_SoundVolume`
  - Громкость звука подбирания подарка
  - По умолчанию: 0.8

## Настройка содержимого

Для более гибкой настройки содержимого подарков, надо включить плагин `DG_MoreBonuses.amxx`.

Также, для добавления некоторых бонусов, нужен плагин `DG_MoreFuncs.amxx`, либо Ваш собственный плагин, регистрирующий новые бонусы.

Файл: `amxmodx/configs/plugins/DeathGift/Gifts.json`.

### Пример

```json
[
    {
        "Name": "Смерть",
        "Chance": 1,
        "Bonus": "Kill"
    },
    {
        "Name": "Тряску экрана",
        "Chance": 15,
        "Bonus": "ScreenShake",
        "Params": {
            "Amplitude": 10,
            "Duration": 3,
            "Frequency": 3
        }
    },
    {
        "Name": "Красный экран",
        "Chance": 20,
        "Bonus": "ScreenFade",
        "Params": {
            "Duration": 5,
            "HoldTime": 3,
            "Green": 0,
            "Blue": 0,
            "Alpha": 127
        }
    }
]
```

### Структура файла

Файл содержит в себе JSON-массив, состоящий из обьектов подарков, поля которых описаны в таблице ниже.

|Поле       |Тип данных |Описание
|:---:      |:---       |:---
|**Name**   |Строка     |Название подарка, выводимое в чате
|**Chance** |Ц.Число    |Шанс выпадения
|**Bonus**  |Строка     |Название бонуса
|**Params** |Обьект     |Массив параметров бонуса

### Как работает шанс выпадения

Для определения, какой подарок должен подняться, складываются шансы всех подарков и берётся случайное число от единицы до суммы шансов. После чего, из полученного числа вычитаются шансы в том же порядке. На каком подарке число стало меньше нуля, тот подарок и выпадает.

## Доступные бонусы для подарков

_ВАЖНО: Для доступа к перечисленным ниже бонусам необходимо включить плагин `DG_MoreFuncs.amxx`._

*В квадратных скобках указано название бонуса, которое надо вписывать в поле `Bonus` в файле `Gifts.json` для использования этого бонуса.

### Выбрасывание оружия [`DropWeapon`]

При поднятии такого подарка, игрок выронит оружие из указанного слота.

#### Параметры

- `Slot` <Строка>
  - Слот, из которого надо выбросить оружие.
  - Доступные слоты: `Primary`, `Secondary`, `Knife`, `Grenade`, `Bomb`.
  - Регистронезависимый.
  - По умолчанию: `Primary`.

---

### AES Бонусы [`AesBonuses`]

Выдаёт указанное количество бонусов для системы рангов AES.

#### Параметры

- `Bonuses` <Целое число>
  - Количество бонусов.
  - По умолчанию: 1.

---

### AES Опыт [`AesExp`]

Выдаёт указанное количество опыта для системы рангов AES.

#### Параметры

- `Exp` <Целое число>
  - Количество опыта.
  - По умолчанию: 1.

---

### Двойной прыжок [`DoubleJump`]

Позволяет игроку совершать двойные прыжки в течении указанного времени.

#### Параметры

- `Duration` <Дробное число>
  - Время в секундах, в течении которого будет доступен двойной прыжок.

---

### Умножение урона [`DamageMult`]

Умножает урон игрока на указанное время.

#### Параметры

- `Duration` <Дробное число>
  - Время в секундах, в течении которого урон будет умножен.
- `Multiplier` <Дробное число>
  - Множитель урона.
  - По умолчанию: 1.25.

---

### Смерть [`Kill`]

Убивает игрока, поднявшего подарок.

#### Параметры

_Параметры отсутствуют._

---

### Заморозка [`Freeze`]

Замораживает игрокам на указанное время.

#### Параметры

- `Duration` <Дробное число>
  - Время в секундах, в течении которого игрок будет заморожен.

---

### Возгорание [`Burn`]

В течении указанного времени наносит игроку урон огнём.

#### Параметры

- `Duration` <Дробное число>
  - Время в секундах, в течении которого игрок будет гореть.
- `Interval` <Дробное число>
  - С каким интервалом будет наноситься урон во время горения.
- `Damage` <Целое число>
  - Урон наносимый огнём.

---

### Отравление [`Poison`]

В течении указанного времени наносит игроку урон ядом.

#### Параметры

- `Duration` <Дробное число>
  - Время в секундах, в течении которого игрок будет отравлен.
- `Interval` <Дробное число>
  - С каким интервалом будет наноситься урон во время отравления.
- `Damage` <Целое число>
  - Урон наносимый ядом.

---

### Тряска экрана [`ScreenShake`]

Трясёт экран игроку, подобравшему подарок.

#### Параметры

- `Amplitude` <Целое число>
  - Амплитуда (сила) тряски.
- `Duration` <Целое число>
  - Время тряски.
- `Frequency` <Целое число>
  - Частота (скорость) тряски.

---

### Подсветка экрана [`ScreenFade`]

Подсвечивает экран игроку как при ослеплении.

#### Параметры

- `Duration` <Целое число>
  - Длительность затухания цвета.
- `HoldTime` <Целое число>
  - Время удержания цвета.
- `Red` <Целое число 0-255>
  - Красный цвет.
  - По умолчанию: 255.
- `Green` <Целое число 0-255>
  - Зелёный цвет.
  - По умолчанию: 255.
- `Blue` <Целое число 0-255>
  - Синий цвет.
  - По умолчанию: 255.
- `Alpha` <Целое число 0-255>
  - Непрозрачность подсветки.
  - По умолчанию: 255.
